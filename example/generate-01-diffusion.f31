begin function (dens_next) = update (dens)
    dens_x = (dens[-4,] + dens + dens[4,] ) / 3
    dens_next = (dens_x[,-1] + dens_x + dens_x[,1] ) / 3
end function
